function AbstractCollection(){function t(){return e.length}function n(){return e}function r(t){return e[t]}function i(t){for(var n=0;n<t;n++){if(e[n]===undefined){return n}}}function s(t,n){var r=[];for(index in e){if(e[index][t]===n)r.push(e[index])}return r}function o(t){for(index in e){if(e[index].name===t){return e[index]}}}function u(t,n){var r=i(100);r>e.length?e.push(t):e[r]=t;if(n!=undefined)n()}function a(t,n){delete e[t];if(n!=undefined)n()}function f(t,n){for(index in e){if(e[index].name===t){delete e[index];if(n!=undefined)n();break}}}var e=[];this.getAll=n;this.removeByName=f;this.removeByIndex=a;this.add=u;this.getByIndex=r;this.getByName=o;this.getCount=t;this.items=e;this.getByObjectAttribute=s;this.getFirstFreeIndex=i}function AbstractContainer(){function t(){this.content.alpha=0;this.content.visible=false;this.content.onTick=this.onTick}function n(){if(this.content.alpha<1){this.content.visible=true;game.tweening=true;var t=createjs.Tween.get(this.content).call(function(){}).to({alpha:1},200,createjs.Ease.linear).call(function(){e.dispatch("fadeInComplete")})}else{e.dispatch("fadeInComplete")}}function r(){if(this.content.alpha>0){game.tweening=true;var t=createjs.Tween.get(this.content).to({alpha:0,visible:false},200,createjs.Ease.linear).call(function(){e.dispatch("fadeOutComplete")})}else{e.dispatch("fadeOutComplete")}}function i(t){e.dispatch("onPressEvent",null,{stageX:t.stageX,target:t.target,type:"background",demo:false})}function s(){}this.name=null;this.type="container";this.content=null;this.parent=null;var e=new Event;this.ready=false;this.fadeIn=n;this.fadeOut=r;this.init=t;this.events=e;this.onPressBackground=i}function AbstractContainersManager(){function r(){this.content.onTick=l;this.ready=true}function i(){n="fadeOut";t.dispatch("fadeOutComplete")}function s(){n="fadeIn";this.current=this.toShow;this.isChanging=false;t.dispatch("fadeInComplete")}function o(e){t.dispatch("onPressEvent",null,e.data)}function u(e){game.backpack.add(e.content)}function a(e){game.containersManager[e.data.action](e.data)}function f(e){switch(e.data.action){case"onPullEnd":outside.pull()}}function l(){}function c(){return n}function h(){return this.isChanging}function p(){return this.current!=undefined?this.current.abstract.name:"undefined"}function d(){return this.current!=undefined?this.current:"undefined"}var e=new ContainersCollection;var t=new Event;this.content=null,this.parent=null;this.isChanging=false,this.toShow,this.current,this.ready=false;var n="none";this.init=r;this.events=t;this.containers=e;this.onFadeIn=s;this.onFadeOut=i;this.state=c;this.getIsChanging=h;this.onPressEvent=o;this.getCurrent=p;this.getCurrentObject=d}function AbstractCreature(){function e(){}this.name=null;this.type="creature";this.animation=null;this.sprite=null;this.parent=null;this.content=null;this.events=new Event;this.init=e}function AbstractDoorLevelItem(){function n(){t={type:this.type,action:this.action,levelUp:this.levelUp,levelDown:this.levelDown,enterX:this.enterX,enterY:this.enterY,postEnterX:this.postEnterX,postEnterY:this.postEnterY,exitX:this.exitX,exitY:this.exitY,postExitX:this.postExitX,postExitY:this.postExitY,demo:false};this.contentUp.onPress=s;this.contentDown.onPress=o;this.contentUp.onMouseOut=r;this.contentUp.onMouseOver=i;this.contentDown.onMouseOut=r;this.contentDown.onMouseOver=i}function r(e){$("body").css("cursor","default")}function i(e){$("body").css("cursor","pointer")}function s(n){t.direction="down";t.target=n.target;t.stageX=t.enterX;e.dispatch("onPressEvent",null,t)}function o(n){t.direction="up";t.target=n.target;t.stageX=t.postExitX;e.dispatch("onPressEvent",null,t)}this.content=null;this.type=null;this.action=null;this.levelUp=0;this.levelDown=0;this.enterX=0;this.enterY=0;this.postEnterX=0;this.postEnterY=0;this.exitX=0;this.exitY=0;this.postExitX=0;this.postExitY=0;this.contentUp=null;this.contentDown=null;var e=new Event;var t={};this.events=e;this.init=n}function AbstractItem(){function n(e,n){t={action:this.action,content:this.content,other:this.otherContent,type:this.type,next:this.arg,after:this.afterAddToBackpack,demo:this.demo};this.content.onPress=o;if(!e){this.content.onMouseOut=i;this.content.onMouseOver=s}this.content.snapToPixel=true;if(undefined!=this.content.image&&!n){var r=new createjs.Shape;nW=this.content.image.width*1.3;nH=this.content.image.height*1.3;r.graphics.beginFill("#fff").drawRect(-nW/2,-nH/2,nW,nH);this.content.hitArea=r}}function r(){t={action:this.action,content:this.content,other:this.otherContent,type:this.type,next:this.arg,after:this.afterAddToBackpack,demo:this.demo}}function i(e){$("body").css("cursor","default")}function s(e){$("body").css("cursor","pointer")}function o(n){t.stageX=n.stageX;t.target=n.target;e.dispatch("onPressEvent",null,t)}function u(){}this.name=null;this.content=null;this.otherContent=null;this.type=null;this.action=null;this.arg=null;this.relationObjectName=null;this.demo=false;var e=new Event;var t={};this.events=e;this.init=n;this.updateData=r;this.afterAddToBackpack=u}function Controller(){function g(){y();t.abstract.events.addEventListener("managerInitComplete",b);t.abstract.events.addEventListener("fadeOutComplete",E);t.abstract.events.addEventListener("fadeInComplete",S);t.abstract.events.addEventListener("onPressEvent",T);t.init();n.abstract.events.addEventListener("managerInitComplete",b);n.abstract.events.addEventListener("fadeOutComplete",E);n.abstract.events.addEventListener("fadeInComplete",S);n.abstract.events.addEventListener("edMoveComplete",N);n.abstract.events.addEventListener("onPressEvent",T);n.abstract.events.addEventListener("gameEnd",q);n.init();r.abstract.events.addEventListener("managerInitComplete",b);r.abstract.events.addEventListener("fadeOutComplete",E);r.abstract.events.addEventListener("fadeInComplete",S);r.init()}function y(){PromptManager.add({locationName:"inside",name:"demo1",status:true,text:TranslatorManager.get("demo1")});PromptManager.add({locationName:"inside",name:"demo2",status:false,text:TranslatorManager.get("demo2")});PromptManager.add({locationName:"inside",name:"demo3",status:false,text:TranslatorManager.get("demo3")});PromptManager.add({locationName:"inside",name:"demo4",status:false,text:TranslatorManager.get("demo4")});PromptManager.add({locationName:"inside",name:"demo5",status:false,text:TranslatorManager.get("demo5")});PromptManager.add({locationName:"brain",name:"brain",status:false,text:TranslatorManager.get("tipBrain")});PromptManager.add({locationName:"outside",name:"outside1",status:false,text:TranslatorManager.get("tipOutside1")});PromptManager.add({locationName:"outside",name:"outside2",status:false,text:TranslatorManager.get("tipOutside2")});PromptManager.add({locationName:"outside",name:"outside3",status:false,text:TranslatorManager.get("tipOutside3")});PromptManager.add({locationName:"inside",name:"inside",status:false,text:TranslatorManager.get("tipInside")});PromptManager.add({locationName:"inside",name:"tube1",status:false,text:TranslatorManager.get("tube1")});PromptManager.add({locationName:"inside",name:"tube2",status:false,text:TranslatorManager.get("tube2")});PromptManager.add({locationName:"inside",name:"honey1",status:false,text:TranslatorManager.get("honey1")});PromptManager.add({locationName:"inside",name:"honey2",status:false,text:TranslatorManager.get("honey2")});PromptManager.add({locationName:"outside",name:"horseshoe1",status:false,text:TranslatorManager.get("horseshoe1")});PromptManager.add({locationName:"inside",name:"horseshoe2",status:false,text:TranslatorManager.get("horseshoe2")});PromptManager.add({locationName:"brain",name:"bottle1",status:false,text:TranslatorManager.get("bottle1")});PromptManager.add({locationName:"inside",name:"bottle2",status:false,text:TranslatorManager.get("bottle2")});PromptManager.add({locationName:"inside",name:"fairy1",status:false,text:TranslatorManager.get("fairy1")});PromptManager.add({locationName:"inside",name:"fairy2",status:false,text:TranslatorManager.get("fairy2")});PromptManager.add({locationName:"outside",name:"magicHorseshoe",status:false,text:TranslatorManager.get("magicHorseshoe")});PromptManager.add({locationName:"inside",name:"angelHair1",status:false,text:TranslatorManager.get("angelHair1")});PromptManager.add({locationName:"clouds",name:"angelHair2",status:false,text:TranslatorManager.get("angelHair2")});PromptManager.add({locationName:"brain",name:"mask1",status:false,text:TranslatorManager.get("mask1")});PromptManager.add({locationName:"inside",name:"mask2",status:false,text:TranslatorManager.get("mask2")});PromptManager.add({locationName:"inside",name:"catHair1",status:false,text:TranslatorManager.get("catHair1")});PromptManager.add({locationName:"inside",name:"catHair2",status:false,text:TranslatorManager.get("catHair2")});PromptManager.add({locationName:"inside",name:"beard",status:false,text:TranslatorManager.get("beard")});PromptManager.add({locationName:"brain",name:"thunderbolt1",status:false,text:TranslatorManager.get("thunderbolt1")});PromptManager.add({locationName:"clouds",name:"thunderbolt2",status:false,text:TranslatorManager.get("thunderbolt2")});PromptManager.add({locationName:"inside",name:"lastTip",status:false,text:TranslatorManager.get("lastTip")});PromptManager.active("demo1")}function b(u){if(t.abstract.ready&&n.abstract.ready&&r.abstract.ready){i.addChild(t.abstract.content);s.addChild(n.abstract.content);o.addChild(r.abstract.content);e.dispatch("controllerInitComplete")}}function w(e){SoundManager.playOffAll();SoundManager.actualLocation=e.next;SoundManager.playOnAll();u=e;if(u.next!=t.getCurrent()&&u.type!="landed"&&u.type!="jump"&&u.type!="landing"){AnimationsCollection.play("controller");if(t.getCurrent()!="undefined"){c=false;BackgroundManager.hide()}else{c=true}t.changeContainer(u);n.hideContainers(u);r.hideGUI(u)}else if(u.type=="jump"){n.jumpToTube(u)}else if(u.type=="landing"){n.jumpFromTube(u)}}function E(e){if(t.abstract.state()=="fadeOut"&&n.abstract.state()=="fadeOut"&&r.abstract.state()=="fadeOut"){t.showNextContainer();n.showContainers();r.showGUI();t.stopSnowing();BackgroundManager.show(u.next);if(!SoundManager.isSoundOn&&c){SoundManager.switchSound();r.gui.soundSwitch.change()}SoundManager.playOnAll(u.next);if(u.next=="brain"&&h==false){h=true;PromptManager.active("brain");PromptManager.active("mask1");PromptManager.active("thunderbolt1");PromptManager.active("bottle1")}if(u.next=="inside"&&m>=3){PromptManager.disactive("brain")}if(u.next=="outside"&&p==false){p=true;PromptManager.active("outside1");PromptManager.active("horseshoe1");PromptManager.active("outside2");PromptManager.active("outside3")}if(u.next=="clouds"&&d==false){d=true;PromptManager.disactive("outside1")}}}function S(e){if(t.abstract.state()=="fadeIn"&&n.abstract.state()=="fadeIn"&&r.abstract.state()=="fadeIn"){AnimationsCollection.stop("controller");n.stageReady();if(t.getCurrent()=="inside"&&f==true){I()}if(c){r.gui.popup.on()}}}function x(e){n.changeLevel(e)}function T(e){if(l==e.data.demo&&!v||e.data.type=="background"){n.catchPressEvent(e);r.hideBackpack()}}function N(e){game.controller[e.data.action](e.data)}function C(e){n.edGoOut(e)}function k(e,n){if(!n&&e.target!=null)if(e.target.name=="tube")t.stopGramophone();r.addToBackpack(e)}function L(e,n){if(!n&&e.target!=null)if(e.target.name=="tube")t.stopGramophone();r.addToBackpackOther(e)}function A(){m+=1}function O(){n.reindeerPull()}function M(e){n.edLanding(e)}function _(){l=false}function D(){t.demoPart2()}function P(e){MergeManager[e.name](e)}function H(e){r.backpackRemoveByName(e)}function B(e){return r.backpackGetByName(e)}function j(){r.hideBackpack()}function F(){_gaq.push(["_trackEvent","game","end","Ukonczenie gry"]);f=true;if(t.getCurrent()=="inside"){I()}}function I(){n.doFinish();v=true}function q(t){SoundManager.isSoundOn=false;SoundManager.mute();e.dispatch("gameEnd")}var e=new Event;var t=new GameplayManager;var n=new AnimationManager;var r=new GUIManager;var i=new createjs.Container;var s=new createjs.Container;var o=new createjs.Container;var u,a=false,f=false,l=true,c=true,h=false,p=false,d=false,v=false,m=0;this.init=g;this.events=e;this.snow=a;this.gameplayManager=t;this.animationManager=n;this.guiManager=r;this.gameplay=i;this.animation=s;this.gui=o;this.changeContainer=w;this.addToBackpack=k;this.addToBackpackOther=L;this.reindeerPull=O;this.edLanding=M;this.goOut=C;this.changeLevel=x;this.backpackItemsMerge=P;this.backpackRemoveByName=H;this.backpackGetByName=B;this.hideBackpack=j;this.gameFinish=F;this.demoEnd=_;this.demoPart2=D;this.brainCleanUp=A}function Game(){function c(){BackgroundManager.init();$(window).resize(function(e){d(e)});Canvas.create(game.onCreateCanvas)}function h(){e=stageGlobal=new createjs.Stage(Canvas.html);createjs.Touch.enable(e,true);e.enableMouseOver(10);e.mouseMoveOutside=false;e.snapToPixelsEnabled=true;e.autoClear=true;v();i.events.addEventListener("controllerInitComplete",p);i.events.addEventListener("gameEnd",m);i.init()}function p(t){e.addChild(i.gameplay);e.addChild(i.animation);e.addChild(i.gui);e.update();this.onGameInit()}function d(e){clearTimeout(n);n=setTimeout(v,500)}function v(){Canvas.scale()}function m(){this.onGameEnd()}function g(){check=this.animating||this.tweening||this.update;if(check){e.update();this.update=false}}var e;var t,n,r;var i=new Controller;var s=0,o=0;var u=false,a=false,f=false;var l;this.init=c;this.onCreateCanvas=h;this.controller=i;this.update=u;this.tweening=a;this.animating=f;this.tick=g;this.stage=e}function Event(){function t(e,t,n){var r=[];var i=arguments.length;for(var s=0;s<i;s++){r.push(arguments[s])}r=r.length>3?r.splice(3,r.length-1):[];if(typeof this.listeners[e]!="undefined"){this.listeners[e].push({scope:n,callback:t,args:r})}else{this.listeners[e]=[{scope:n,callback:t,args:r}]}}function n(e,t,n){if(typeof this.listeners[e]!="undefined"){var r=this.listeners[e].length;var i=[];for(var s=0;s<r;s++){var o=this.listeners[e][s];if(o.scope==n&&o.callback==t){}else{i.push(o)}}this.listeners[e]=i}}function r(e,t,n){var r=0;var i={type:e,target:t,data:n};var s=[];var o=arguments.length;for(var u=0;u<o;u++){s.push(arguments[u])}s=s.length>2?s.splice(2,s.length-1):[];s=[i].concat(s);if(typeof this.listeners[e]!="undefined"){var a=this.listeners[e].length;for(var u=0;u<a;u++){var f=this.listeners[e][u];if(f&&f.callback){f.args=s.concat(f.args);f.callback.apply(f.scope,f.args);r+=1}}}}function i(){var e="";for(var t in this.listeners){var n=this.listeners[t].length;for(var r=0;r<n;r++){var i=this.listeners[t][r];e+=i.scope&&i.scope.className?i.scope.className:"anonymous";e+=" listen for '"+t+"'\n"}}return e}this.listeners={};var e={};this.data=e;this.addEventListener=t;this.removeEventListener=n;this.dispatch=r;this.getEvents=i}function AnimationManager(){function g(){e.content=new createjs.Container;e.content.name="animations";t.abstract.parent=this;t.abstract.events.addEventListener("initComplete",y);t.abstract.events.addEventListener("onPressEvent",e.onPressEvent);t.abstract.events.addEventListener("edMoveComplete",x);t.abstract.events.addEventListener("edAnimationEvent",N);t.init();o.abstract.parent=this;o.abstract.events.addEventListener("initComplete",y);o.abstract.events.addEventListener("onPressEvent",e.onPressEvent);o.abstract.events.addEventListener("reindeerMoo",k);o.init();u.abstract.parent=this;u.abstract.events.addEventListener("initComplete",y);u.abstract.events.addEventListener("onPressEvent",e.onPressEvent);u.abstract.events.addEventListener("gameEnd",E);u.init();a.abstract.parent=this;a.abstract.events.addEventListener("initComplete",y);a.abstract.events.addEventListener("onPressEvent",e.onPressEvent);a.init();f.abstract.parent=this;f.abstract.events.addEventListener("initComplete",y);f.abstract.events.addEventListener("onPressEvent",e.onPressEvent);f.init();s.abstract.parent=this;s.abstract.events.addEventListener("initComplete",y);s.abstract.events.addEventListener("onPressEvent",e.onPressEvent);s.abstract.events.addEventListener("catHair",q);s.init();l.abstract.parent=this;l.abstract.events.addEventListener("initComplete",y);l.init()}function y(i){e.containers.add(i.target);if(e.containers.length()==7){e.content.addChild(o.abstract.content);e.content.addChild(u.abstract.content);e.content.addChild(a.abstract.content);e.content.addChild(f.abstract.content);e.content.addChild(s.abstract.content);n.abstract.parent=this;n.init();n.abstract.content.rotation=-90;n.abstract.content.x=724;n.abstract.content.y=402;n.abstract.content.visible=false;n.abstract.content.onPress=j;e.content.addChild(n.abstract.content);r.abstract.parent=this;r.abstract.events.addEventListener("onPressEvent",I);r.init();r.abstract.content.x=207;r.abstract.content.y=482;r.abstract.content.visible=false;e.content.addChild(r.abstract.content);e.content.addChild(t.abstract.content);e.content.addChild(l.abstract.content);e.init();e.events.dispatch("managerInitComplete")}}function b(){t.stageReady()}function w(e){}function E(t){e.events.dispatch("gameEnd")}function S(e){t.catchOnPressEvent(e)}function x(t){e.events.dispatch("edMoveComplete",null,t.data)}function T(e){t.goOut(e)}function N(e){if(e.data.action=="onPullEnd")o.pull()}function C(){t.reindeerPull()}function k(e){t.edFly(e.data)}function L(t){c=0;nextData=t;for(i=0;i<e.containers.length();i++){e.containers.getByIndex(i).container.abstract.events.addEventListener("fadeOutComplete",A);e.containers.getByIndex(i).container.abstract.fadeOut()}var s=createjs.Tween.get(n.abstract.content).to({alpha:0},200,createjs.Ease.linear);var o=createjs.Tween.get(r.abstract.content).to({alpha:0},200,createjs.Ease.linear)}function A(t){c+=1;if(c==e.containers.length())e.onFadeOut()}function O(){c=0;h=3;if(nextData.next=="outside"){o.abstract.events.addEventListener("fadeInComplete",M);o.reindeerCacheUpdate();o.abstract.fadeIn()}else if(nextData.next=="inside"){h=6;u.abstract.events.addEventListener("fadeInComplete",M);u.abstract.fadeIn();a.abstract.events.addEventListener("fadeInComplete",M);a.abstract.fadeIn();f.abstract.events.addEventListener("fadeInComplete",M);f.abstract.fadeIn();s.abstract.events.addEventListener("fadeInComplete",M);s.abstract.fadeIn();if(d){n.abstract.content.visible=true}if(v){r.abstract.content.visible=true}var e=createjs.Tween.get(n.abstract.content).to({alpha:1},200,createjs.Ease.linear);var i=createjs.Tween.get(r.abstract.content).to({alpha:1},200,createjs.Ease.linear)}else{h=2}t.setLocation(nextData);t.abstract.events.addEventListener("fadeInComplete",M);t.abstract.fadeIn();l.setLocation(nextData.next);l.abstract.events.addEventListener("fadeInComplete",M);l.abstract.fadeIn()}function M(t){c+=1;if(c==h){e.onFadeIn()}}function _(e){t.edLanding(e)}function D(e){t.changeLevel(e)}function P(){d=true;n.abstract.content.visible=true;n.abstract.content.alpha=1}function H(e){t.jumpToTube(e)}function B(e){t.jumpFromTube(e)}function j(t){var r={action:"changeContainer",content:this.content,type:"jump",next:"brain",stageX:n.abstract.content.x-104,target:t.target,demo:false};e.events.dispatch("onPressEvent",null,r)}function F(){s.scare()}function I(t){e.events.dispatch("onPressEvent",null,t.data)}function q(e){v=true;r.abstract.content.visible=true}function R(e){a.addCake(e)}function U(){u.showBeard()}function z(){e.content.removeChild(f.abstract.content)}function W(){o.showHorseshoe()}function X(){if(!m){m=true;a.abstract.events.addEventListener("clockShoutComplete",V);a.shout()}}function V(){n.abstract.content.visible=false;u.wakeUp()}var e=new AbstractContainersManager,t=new EdContainer,n=new TubeItem,r=new CatHairItem,s=new CatContainer,o=new ReindeerContainer,u=new SantaClausContainer,a=new ClockContainer,f=new FairyContainer,l=new FrontLayerContainer;var c=0,h=0,p,d=false,v=false,m=false;this.init=g;this.abstract=e;this.onContainerInit=y;this.hideContainers=L;this.showContainers=O;this.catchPressEvent=S;this.reindeerPull=C;this.edLanding=_;this.edGoOut=T;this.jumpToTube=H;this.jumpFromTube=B;this.stageReady=b;this.changeLevel=D;this.showTube=P;this.scareCat=F;this.clockEat=R;this.showBeard=U;this.hideFairy=z;this.showMagicHorseshoe=W;this.doFinish=X}function GameplayManager(){function u(){e.content=new createjs.Container;e.content.name="gameplay";t.abstract.parent=this;t.abstract.events.addEventListener("initComplete",a);t.abstract.events.addEventListener("onPressEvent",e.onPressEvent);t.init();n.abstract.parent=this;n.abstract.events.addEventListener("initComplete",a);n.abstract.events.addEventListener("onPressEvent",e.onPressEvent);n.abstract.events.addEventListener("reindeerMoo",p);n.init();r.abstract.parent=this;r.abstract.events.addEventListener("initComplete",a);r.abstract.events.addEventListener("onPressEvent",e.onPressEvent);r.init();i.abstract.parent=this;i.abstract.events.addEventListener("initComplete",a);i.abstract.events.addEventListener("onPressEvent",e.onPressEvent);i.init()}function a(o){e.containers.add(o.target);if(e.containers.length()==4){s=t;e.content.addChild(t.abstract.content);e.content.addChild(n.abstract.content);e.content.addChild(r.abstract.content);e.content.addChild(i.abstract.content);e.init();e.events.dispatch("managerInitComplete")}}function f(e){}function l(t){if(e.containers.getByName(t.next)!=undefined&&!e.getIsChanging()){e.isChanging=true;e.toShow=e.containers.getByName(t.next);if(e.current!==undefined){e.current.abstract.events.addEventListener("fadeOutComplete",e.onFadeOut);e.current.abstract.fadeOut()}else{e.onFadeOut()}}}function c(){e.toShow.abstract.events.addEventListener("fadeInComplete",h);e.toShow.cacheUpdate();e.toShow.abstract.fadeIn()}function h(){e.isChanging=false;e.onFadeIn()}function p(e){}function d(){}function v(){return e.getCurrent()}function m(){return e.getCurrentObject()}function g(){t.stopGramophone()}function y(){r.lightStar();n.lightStar()}function b(){r.sewCloud();n.sewCloud()}function w(){r.stopSnowing()}function E(){t.demoPart2()}var e=new AbstractContainersManager;var t=new InsideContainer;var n=new OutsideContainer;var r=new CloudsContainer;var i=new BrainContainer;var s,o=null;this.init=u;this.abstract=e;this.onContainerInit=a;this.changeContainer=l;this.showNextContainer=c;this.getCurrent=v;this.getCurrentObject=m;this.stopGramophone=g;this.lightStar=y;this.sewCloud=b;this.stopSnowing=w;this.demoPart2=E}function GUIManager(){function n(){e.content=new createjs.Container;e.content.name="gui";t.abstract.parent=this;t.abstract.events.addEventListener("initComplete",r);t.abstract.events.addEventListener("onPressEvent",e.onPressEvent);t.abstract.events.addEventListener("popupOff",d);t.init()}function r(n){e.containers.add(n.target);if(e.containers.length()==1){e.content.addChild(t.abstract.content);e.init();e.events.dispatch("managerInitComplete")}}function i(e){t.abstract.events.addEventListener("fadeOutComplete",s);t.abstract.fadeOut()}function s(t){e.onFadeOut()}function o(){t.abstract.events.addEventListener("fadeInComplete",u);t.abstract.fadeIn()}function u(t){e.onFadeIn()}function a(e){}function f(e){t.addToBackpack(e)}function l(e){t.addToBackpackOther(e)}function c(){t.hideBackpack()}function h(e){t.backpackRemoveByName(e)}function p(e){return t.backpackGetByName(e)}function d(t){e.events.dispatch("popupOff")}var e=new AbstractContainersManager;var t=new GUIContainer;this.init=n;this.abstract=e;this.onContainerInit=r;this.hideGUI=i;this.showGUI=o;this.addToBackpack=f;this.addToBackpackOther=l;this.hideBackpack=c;this.backpackRemoveByName=h;this.backpackGetByName=p;this.gui=t}function BrainContainer(){function p(){e.name="brain";d();e.content=new createjs.Container;var p=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(0,255,0,.01)).rect(320,60,370,85);t=new createjs.Shape(p);t.level="0";e.content.addChild(t);t.onPress=e.onPressBackground;var g=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(0,255,0,.01)).rect(220,153,500,85);n=new createjs.Shape(g);n.level="1";e.content.addChild(n);n.onPress=e.onPressBackground;var y=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(0,255,0,.01)).rect(370,260,260,85);r=new createjs.Shape(y);r.level="2";e.content.addChild(r);r.onPress=e.onPressBackground;var b=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(0,255,0,.01)).rect(320,370,330,100);i=new createjs.Shape(b);i.level="3";e.content.addChild(i);i.onPress=e.onPressBackground;s.abstract.events.addEventListener("onPressEvent",v);s.abstract.arg="inside";s.abstract.type="landing";s.init();s.abstract.content.level=0;s.abstract.content.x=290;s.abstract.content.y=50;s.abstract.content.scaleX=.5;e.content.addChild(s.abstract.content);o.abstract.events.addEventListener("onPressEvent",m);o.abstract.contentUp=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,50,100));o.abstract.contentUp.x=630;o.abstract.contentUp.y=50;o.abstract.contentDown=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,30,80));o.abstract.contentDown.x=550;o.abstract.contentDown.y=155;o.abstract.levelUp=o.abstract.contentUp.level=0;o.abstract.levelDown=o.abstract.contentDown.level=1;o.abstract.enterX=680;o.abstract.enterY=68;o.abstract.postEnterX=630;o.abstract.postEnterY=68;o.abstract.exitX=565;o.abstract.exitY=68;o.abstract.postExitX=565;o.abstract.postExitY=160;o.init();e.content.addChild(o.abstract.content);u.abstract.events.addEventListener("onPressEvent",m);u.abstract.contentUp=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,50,100));u.abstract.contentUp.x=700;u.abstract.contentUp.y=150;u.abstract.contentDown=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,50,100));u.abstract.contentDown.x=625;u.abstract.contentDown.y=250;u.abstract.levelUp=u.abstract.contentUp.level=1;u.abstract.levelDown=u.abstract.contentDown.level=2;u.abstract.enterX=680;u.abstract.enterY=158;u.abstract.postEnterX=750;u.abstract.postEnterY=158;u.abstract.exitX=665;u.abstract.exitY=270;u.abstract.postExitX=605;u.abstract.postExitY=270;u.init();e.content.addChild(u.abstract.content);a.abstract.events.addEventListener("onPressEvent",m);a.abstract.contentUp=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,60,30));a.abstract.contentUp.x=485;a.abstract.contentUp.y=325;a.abstract.contentDown=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,60,30));a.abstract.contentDown.x=485;a.abstract.contentDown.y=360;a.abstract.levelUp=a.abstract.contentUp.level=2;a.abstract.levelDown=a.abstract.contentDown.level=3;a.abstract.enterX=515;a.abstract.enterY=270;a.abstract.postEnterX=515;a.abstract.postEnterY=298;a.abstract.exitX=515;a.abstract.exitY=300;a.abstract.postExitX=515;a.abstract.postExitY=380;a.init();e.content.addChild(a.abstract.content);f=new createjs.Bitmap("media/img/sock.png");f.x=495;f.y=145;e.content.addChild(f);l.abstract.events.addEventListener("onPressEvent",m);l.init();l.abstract.content.x=621;l.abstract.content.y=430;l.abstract.content.scaleX=l.abstract.content.scaleY=.6;e.content.addChild(l.abstract.content);c.abstract.events.addEventListener("onPressEvent",m);c.init();c.abstract.content.x=366;c.abstract.content.y=323;e.content.addChild(c.abstract.content);h.abstract.events.addEventListener("onPressEvent",m);h.init();h.abstract.content.x=380;h.abstract.content.y=442;e.content.addChild(h.abstract.content);e.init();e.events.dispatch("initComplete",this)}function d(){SoundManager.addLocation("brain");SoundManager.addSoundToLocation("brain","brain")}function v(t){var n={stageX:t.data.target.x+t.data.target.scaleX*100,action:"goOut",content:t.data.content,type:t.data.type,target:t.data.target,next:t.data.next,demo:false};e.events.dispatch("onPressEvent",null,n)}function m(t){e.events.dispatch("onPressEvent",null,t.data)}function g(){}var e=new AbstractContainer;var t,n,r,i,s=new DoorItem,o=new DoorLevelItem,u=new DoorLevelItem,a=new DoorLevelItem;var f,l=new MaskItem,c=new BottleItem,h=new ThunderboltItem;this.init=p;this.abstract=e;this.cacheUpdate=g}function CatContainer(){function n(){e.content=new createjs.Container;t.abstract.events.addEventListener("onPressEvent",r);t.abstract.events.addEventListener("catHair",s);t.init();e.content.addChild(t.abstract.content);e.init();e.events.dispatch("initComplete",this)}function r(t){e.events.dispatch("onPressEvent",null,t.data)}function i(){t.scare()}function s(t){e.events.dispatch("catHair",null,t.data)}var e=new AbstractContainer;var t=new CatCreature;this.init=n;this.abstract=e;this.scare=i}function ClockContainer(){function n(){e.name="clock";e.content=new createjs.Container;t.abstract.events.addEventListener("onPressEvent",r);t.abstract.events.addEventListener("clockShoutComplete",i);t.init();e.content.addChild(t.abstract.content);e.content.x=593;e.content.y=238;e.init();e.events.dispatch("initComplete",this)}function r(t){e.events.dispatch("onPressEvent",null,t.data)}function i(t){e.events.dispatch("clockShoutComplete",null,t.data)}function s(e){t.addCake(e)}function o(){t.shout()}var e=new AbstractContainer;var t=new ClockItem;this.init=n;this.abstract=e;this.addCake=s;this.shout=o}function CloudsContainer(){function o(){e.name="clouds";u();e.content=new createjs.Container;var o=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.01)).rect(0,0,Canvas.width/2+100,Canvas.height);t=new createjs.Shape(o);e.content.addChild(t);t.onPress=e.onPressBackground;n.abstract.events.addEventListener("onPressEvent",a);n.abstract.arg="outside";n.init();n.abstract.content.x=Canvas.width/2+100;n.abstract.content.y=Canvas.height-150;n.abstract.content.scaleX=n.abstract.content.scaleY=20;e.content.addChild(n.abstract.content);s.init();s.abstract.content.x=Canvas.width/2-130;s.abstract.content.y=150;e.content.addChild(s.abstract.content);r.init();r.abstract.content.x=Canvas.width/2-130;r.abstract.content.y=50;e.content.addChild(r.abstract.content);i.init();i.abstract.content.x=118;i.abstract.content.y=110;e.content.addChild(i.abstract.content);e.init();e.events.dispatch("initComplete",this)}function u(){SoundManager.addLocation("clouds");SoundManager.addSoundToLocation("clouds","clouds")}function a(t){var r=t.data;if(r.type=="exit"){r.action="edLanding";r.stageX=n.abstract.content.x}e.events.dispatch("onPressEvent",null,r)}function f(){i.lightUp()}function l(){r.sewCloud();s.startSnowing()}function c(){s.stopSnowing()}function h(){i.cacheUpdate();r.cacheUpdate()}var e=new AbstractContainer;var t,n=new DoorItem,r=new CloudItem,i=new StarItem,s=new SnowItem;this.init=o;this.abstract=e;this.lightStar=f;this.sewCloud=l;this.stopSnowing=c;this.cacheUpdate=h}function EdContainer(){function l(){e.name="ed";e.content=new createjs.Container;f=this;t.abstract.events.addEventListener("walkComplete",v);t.abstract.events.addEventListener("flyComplete",v);t.abstract.events.addEventListener("landingComplete",v);t.abstract.events.addEventListener("fallingComplete",v);t.abstract.events.addEventListener("moveComplete",v);t.abstract.events.addEventListener("animationEvent",m);t.abstract.events.addEventListener("jumpStarted",g);t.abstract.events.addEventListener("landingStarted",y);t.abstract.events.addEventListener("initComplete",c);t.abstract.parent=this;t.init()}function c(){e.content.addChild(t.abstract.content);e.content.snapToPixel=true;e.init();e.events.dispatch("initComplete",f)}function h(){t.stageReady();t.abstract.content.alpha=1;if(r!=null)if(r.type=="goOut")t.jumpFromTube(r)}function p(i){e.content.removeChild(n);t.setLocation(t.locations[i.next]);r=i;if(i.type=="goOut"&&i.next=="inside"){t.abstract.content.x=745;t.abstract.content.y=415;t.abstract.content.scaleX=t.abstract.content.scaleY=.1}}function d(e){if(!t.isMoving())t.walkTo(e.data)}function v(r){if(!s&&!o){if(r.data)if(r.data.type=="goOut"){t.abstract.content.alpha=0;e.content.removeChild(n)}if(r.data.type!="background")e.events.dispatch("edMoveComplete",null,r.data)}else{if(s)E();else if(o)S()}}function m(t){e.events.dispatch("edAnimationEvent",null,t.data)}function g(r){e.content.removeChild(n);n=new createjs.Bitmap("media/img/tubeDoor.png");n.x=703;n.y=409;e.content.addChild(n);r.data.type="exit";u=createjs.Tween.get(t.abstract.content).to({x:790,y:250,rotation:90,scaleX:.8,scaleY:.8},200,createjs.Ease.sineIn).to({x:720,y:375,rotation:180},200,createjs.Ease.sineOut).to({x:740,y:435,scaleX:.2,scaleY:.2,alpha:0},200,createjs.Ease.sineOut).wait(500).call(function(){e.content.removeChild(n);t.abstract.content.alpha=0;e.events.dispatch("edMoveComplete",null,r.data)})}function y(r){e.content.removeChild(n);n=new createjs.Bitmap("media/img/tubeDoor.png");n.x=703;n.y=409;e.content.addChild(n);u=createjs.Tween.get(t.abstract.content).wait(500).to({x:700,y:200,scaleX:.8,scaleY:.8},200,createjs.Ease.sineIn).to({x:640,y:t.locations["inside"].y,scaleX:t.locations["inside"].scale,scaleY:t.locations["inside"].scale},200,createjs.Ease.sineOut).call(function(){t.jumpFromTubeEnd();e.content.removeChild(n)})}function b(t){if(t.levelUp==0){e.content.removeChild(n);n=new createjs.Bitmap("media/img/brainExit1.png");n.x=528;n.y=63;e.content.addChild(n)}else if(t.levelUp==1){e.content.removeChild(n);n=new createjs.Container;var r=new createjs.Bitmap("media/img/brainExit3.png");r.x=693;r.y=134;n.addChild(r);var s=new createjs.Bitmap("media/img/brainExit4.png");s.x=611;s.y=263;n.addChild(s);e.content.addChild(n)}if(t.direction=="down"){i={x1:t.enterX,y1:t.enterY,x2:t.postEnterX,y2:t.postEnterY,x3:t.exitX,y3:t.exitY,x4:t.postExitX,y4:t.postExitY,level:t.levelDown,target:t.target}}else if(t.direction=="up"){i={x1:t.postExitX,y1:t.postExitY,x2:t.exitX,y2:t.exitY,x3:t.postEnterX,y3:t.postEnterY,x4:t.enterX,y4:t.enterY,level:t.levelUp,target:t.target}}w()}function w(){s=true;o=false;t.abstract.content.x=i.x1;t.abstract.content.y=i.y1;var e={stageX:i.x2,stageY:i.y2,target:i.target};i.y1==i.y2?t.walkTo(e):t.flyTo(e)}function E(){s=false;o=true;t.abstract.content.x=i.x3;t.abstract.content.y=i.y3;var e={stageX:i.x4,stageY:i.y4,level:i.level,target:i.target};i.y3==i.y4?t.walkTo(e):t.flyTo(e)}function S(){s=false;o=false;t.setLevel(i.level);e.content.removeChild(n)}function x(r){var i,s;if(r.next=="inside"){i="changeContainer";s="goOut";e.content.removeChild(n);n=new createjs.Bitmap("media/img/brainExit0.png");n.x=239;n.y=57;e.content.addChild(n)}var o={action:i,next:r.next,target:r.target,stageX:260,type:s};t.walkTo(o)}function T(t){e.events.dispatch("onPressEvent",null,t.data)}function N(){t.pull()}function C(e){t.fly(e)}function k(e){t.landTo(e)}function L(e){t.jumpToTube(e)}function A(e){t.jumpFromTube(e)}function O(){t.moonWalk()}var e=new AbstractContainer;var t=new EdCreature,n,r;var i,s=false,o=false,u,a=true,f;this.init=l;this.abstract=e;this.stageReady=h;this.setLocation=p;this.catchOnPressEvent=d;this.reindeerPull=N;this.edFly=C;this.goOut=x;this.changeLevel=b;this.edLanding=k;this.jumpToTube=L;this.jumpFromTube=A;this.stageReady=h;this.moonWalk=O}function FairyContainer(){function n(){e.name="fairy";e.content=new createjs.Container;t.abstract.events.addEventListener("onPressEvent",r);t.init();e.content.addChild(t.abstract.content);e.init();e.events.dispatch("initComplete",this)}function r(t){e.events.dispatch("onPressEvent",null,t.data)}var e=new AbstractContainer;var t=new FairyCreature;this.init=n;this.abstract=e}function FrontLayerContainer(){function f(){e.content=new createjs.Container;e.name="frontLayer";t=new createjs.Bitmap("media/img/smallCloud.png");t.visible=false;t.x=120;t.y=Canvas.height-200;e.content.addChild(t);n=new createjs.Bitmap("media/img/frontChaos.png");n.visible=false;n.x=200;n.y=Canvas.height-90;e.content.addChild(n);r=new createjs.Bitmap("media/img/barrel.png");r.x=Canvas.width-80;r.y=Canvas.height-150;e.content.addChild(r);i=new createjs.Bitmap("media/img/pipes.png");i.x=323;i.y=197;e.content.addChild(i);s=new createjs.Bitmap("media/img/pipe.png");s.x=480;s.y=335;e.content.addChild(s);o=new createjs.Bitmap("media/img/nerves.png");o.x=312;o.y=327;e.content.addChild(o);u=new createjs.Bitmap("media/img/mud.png");u.x=260;u.y=267;e.content.addChild(u);e.init();e.events.dispatch("initComplete",this)}function l(e){t.visible=e=="clouds";n.visible=r.visible=e=="inside";i.visible=o.visible=u.visible=s.visible=e=="brain"}function c(t){e.events.dispatch("onPressEvent",null,t.data)}var e=new AbstractContainer;var t,n,r,i,s,o,u,a;this.init=f;this.abstract=e;this.setLocation=l}function GUIContainer(){function o(){PromptManager.events.addEventListener("activePrompt",c);e.name="gui";e.content=new createjs.Container;i.abstract.events.addEventListener("popupOff",v);i.abstract.events.addEventListener("disactivePrompt",h);i.init();e.content.addChild(i.abstract.content);t.init();e.content.addChild(t.content);n.init();n.abstract.content.onPress=function(){n.animate();SoundManager.switchSound();n.change()};e.content.addChild(n.abstract.content);r.init();r.abstract.content.onPress=function(){r.animate();i.switchView()};e.content.addChild(r.abstract.content);btnItems=new BtnBackpackItem;btnItems.init();btnItems.abstract.content.onPress=function(){btnItems.animate();t.switchView()};e.content.addChild(btnItems.abstract.content);e.init();e.events.dispatch("initComplete",this)}function u(t){e.events.dispatch("onPressEvent",null,t.data)}function a(e){t.add(e.content);e.after()}function f(e){e.content.parent.removeChild(e.content);e.after();t.add(e.other)}function l(){t.hide()}function c(e){r.activeAnimateStart()}function h(e){r.activeAnimateStop()}function p(e){t.removeByName(e)}function d(e){return t.getByName(e)}function v(){e.events.dispatch("popupOff")}var e=new AbstractContainer;var t=new BackpackCollection,n=new BtnSoundItem,r=new BtnPromptItem,i=new PopupItem;var s;this.init=o;this.abstract=e;this.addToBackpack=a;this.addToBackpackOther=f;this.hideBackpack=l;this.backpackRemoveByName=p;this.backpackGetByName=d;this.soundSwitch=n;this.popup=i}function InsideContainer(){function h(){e.name="inside";p();e.content=new createjs.Container;var r=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.01)).rect(0,0,Canvas.width,Canvas.height);t=new createjs.Shape(r);e.content.addChild(t);t.onPress=e.onPressBackground;i.abstract.events.addEventListener("onPressEvent",d);i.abstract.arg="outside";i.init();i.abstract.content.y=250;i.abstract.content.scaleX=.5;i.abstract.content.scaleY=2.5;e.content.addChild(i.abstract.content);u.abstract.events.addEventListener("onPressEvent",d);u.init();e.content.addChild(u.abstract.content);f.abstract.events.addEventListener("onPressEvent",d);f.init();f.abstract.content.x=405;f.abstract.content.y=282;e.content.addChild(f.abstract.content);a.abstract.events.addEventListener("onPressEvent",d);a.init();a.abstract.content.x=312;a.abstract.content.y=295;e.content.addChild(a.abstract.content);l.abstract.events.addEventListener("onPressEvent",d);l.init();l.abstract.content.x=245;l.abstract.content.y=363;e.content.addChild(l.abstract.content);c.abstract.events.addEventListener("onPressEvent",d);c.init();c.abstract.content.x=366;c.abstract.content.y=440;e.content.addChild(c.abstract.content);n=new createjs.Bitmap("media/img/tableLeg.png");n.x=360;n.y=398;e.content.addChild(n);o.abstract.events.addEventListener("onPressEvent",d);o.init();o.abstract.content.x=245;o.abstract.content.y=270;e.content.addChild(o.abstract.content);var s=new createjs.Bitmap("media/img/nail2.png");s.x=233;s.y=235;e.content.addChild(s);e.init();e.events.dispatch("initComplete",this)}function p(){SoundManager.addLocation("inside");SoundManager.addSoundToLocation("inside","snore");SoundManager.addSoundToLocation("inside","gramophone");SoundManager.actualLocation="inside"}function d(t){e.events.dispatch("onPressEvent",null,t.data)}function v(){a.stop()}function m(){o.abstract.demo=true;o.abstract.updateData()}function g(){}var e=new AbstractContainer;var t,n,r,i=new DoorItem,s=new DoorItem,o=new KnifeItem,u=new AngelHairItem,a=new GramophoneItem,f=new TubeItem,l=new CakeItem,c=new HoneyItem;this.init=h;this.abstract=e;this.stopGramophone=v;this.demoPart2=m;this.cacheUpdate=g}function OutsideContainer(){function a(){e.name="outside";f();e.content=new createjs.Container;var t=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.01)).rect(0,0,Canvas.width,Canvas.height);n=new createjs.Shape(t);e.content.addChild(n);n.onPress=e.onPressBackground;r.abstract.events.addEventListener("onPressEvent",l);r.abstract.arg="inside";r.init();r.abstract.content.x=Canvas.width/2+170;r.abstract.content.y=Canvas.height-190;r.abstract.content.scaleX=.5;e.content.addChild(r.abstract.content);i.abstract.name="cloudSmall";i.init();i.abstract.content.x=Canvas.width/2-160;i.abstract.content.y=25;i.abstract.content.scaleX=.45;i.abstract.content.scaleY=.45;e.content.addChild(i.abstract.content);s.abstract.name="starSmall";s.init();s.abstract.content.x=Canvas.width/2-280;s.abstract.content.y=33;s.abstract.content.scaleX=.5;s.abstract.content.scaleY=.5;e.content.addChild(s.abstract.content);u.abstract.events.addEventListener("onPressEvent",l);u.init();u.abstract.content.x=Canvas.width/2+195;u.abstract.content.y=Canvas.height/2+110;e.content.addChild(u.abstract.content);o=new createjs.Bitmap("media/img/nail.png");o.x=Canvas.width/2+185;o.y=Canvas.height/2+95;e.content.addChild(o);e.init();e.events.dispatch("initComplete",this)}function f(){SoundManager.addLocation("outside");SoundManager.addSoundToLocation("outside","outside")}function l(t){e.events.dispatch("onPressEvent",null,t.data)}function c(t){e.events.dispatch("reindeerMoo",null,t.data)}function h(){s.lightUpStill()}function p(){i.sewCloud()}function d(){s.cacheUpdate();i.cacheUpdate()}var e=new AbstractContainer;var t,n,r=new DoorItem,i=new CloudItem,s=new StarItem,o,u=new HorseshoeItem;this.init=a;this.abstract=e;this.lightStar=h;this.sewCloud=p;this.cacheUpdate=d}function ReindeerContainer(){function r(){e.name="reindeer";e.content=new createjs.Container;n=this;t.abstract.events.addEventListener("initComplete",i);t.abstract.events.addEventListener("onPressEvent",s);t.abstract.events.addEventListener("reindeerMoo",o);t.abstract.events.addEventListener("reindeerMoveEd",u);t.init()}function i(r){e.content.addChild(t.abstract.content);e.init();e.events.dispatch("initComplete",n)}function s(t){e.events.dispatch("onPressEvent",null,t.data)}function o(t){e.events.dispatch("reindeerMoo",null,t.data)}function u(t){var n={stageX:420,type:"background",demo:false};e.events.dispatch("onPressEvent",null,n)}function a(){t.pull()}function f(){t.showHorseshoe()}function l(){t.reindeerCacheUpdate()}var e=new AbstractContainer;var t=new ReindeerCreature,n;this.init=r;this.abstract=e;this.pull=a;this.showHorseshoe=f;this.reindeerCacheUpdate=l}function SantaClausContainer(){function n(){e.content=new createjs.Container;e.name=e.content.name="santa";t.abstract.events.addEventListener("onPressEvent",r);t.abstract.events.addEventListener("gameEnd",i);t.init();e.content.addChild(t.abstract.content);e.init();e.events.dispatch("initComplete",this)}function r(t){e.events.dispatch("onPressEvent",null,t.data)}function i(t){e.events.dispatch("gameEnd")}function s(){t.showBeard()}function o(){t.wakeUp()}var e=new AbstractContainer;var t=new SantaClausCreature;this.init=n;this.abstract=e;this.showBeard=s;this.wakeUp=o}function CatCreature(){function i(){e.content=new createjs.Container;e.sprite=new createjs.SpriteSheet({frames:{width:118,regY:0,height:113,count:60,regX:0},animations:{awake:[2,59],sleep:[0,1]},images:["media/spritesheets/cat.png"]});e.animation=new createjs.BitmapAnimation(e.sprite);e.name=e.animation.name="cat";e.content.addChild(e.animation);e.content.x=150;e.content.y=375;e.content.snapToPixel=true;e.animation.onTick=s;e.content.cache(0,0,118,113);e.animation.gotoAndStop(0);n=true;r=setInterval(o,5e3)}function s(){if(t||n){n=false;e.content.updateCache()}}function o(){e.animation.gotoAndStop(1);n=true;clearInterval(r);r=setInterval(u,5e3)}function u(){e.animation.gotoAndStop(0);n=true;clearInterval(r);r=setInterval(o,5e3)}function a(){clearInterval(r);t=true;AnimationsCollection.play("cat");e.animation.onAnimationEnd=f;e.animation.gotoAndPlay("awake")}function f(){t=false;n=true;e.animation.onAnimationEnd=null;e.animation.gotoAndStop(0);e.events.dispatch("catHair",null);AnimationsCollection.stop("cat")}var e=new AbstractCreature;var t=false,n=false,r;this.init=i;this.abstract=e;this.scare=a}function EdCreature(){function T(){e.content=new createjs.Container;e.name=e.content.name="ed";e.sprite=new createjs.SpriteSheet({animations:{start:[0,3],walk:[4,27],pull:[28,42],pullEnd:[43,60],jump:[61,72],jumpEnd:[73,77],landing:[78,81],landingEnd:[82,94]},images:["media/spritesheets/ed.png"],frames:{width:132,regY:0,height:189,count:95,regX:132/2}});b=setInterval(N,500)}function N(){if(e.sprite.complete){clearInterval(b);C()}}function C(){createjs.SpriteSheetUtils.addFlippedFrames(e.sprite,true,false,false);e.animation=new createjs.BitmapAnimation(e.sprite);e.sprite.getAnimation("pull").next="pullEnd";e.sprite.getAnimation("landing").next="landingEnd";e.sprite.getAnimation("pull_h").next="pullEnd_h";e.sprite.getAnimation("landing_h").next="landingEnd_h";e.content.x=x["inside"].x;e.content.y=x["inside"].y;e.animation.direction=90;e.animation.scaleX=e.animation.scaleY=1;e.content.addChild(e.animation);e.content.snapToPixel=true;e.animation.onTick=J;e.content.cache(-66,0,133,192);X();e.events.dispatch("initComplete")}function k(){e.content.updateCache();X();if(y===x.clouds){h=true;AnimationsCollection.play("ed")}}function L(t){y=t;e.content.x=Utils.round(t.x);t===x.clouds?e.content.y=-500:e.content.y=Utils.round(t.y);if(t===x.brain)u=1;i=t.vX;e.content.scaleX=t.scale;e.content.scaleY=t.scale;e.content.rotation=0}function A(e){if(!c){E=e;if(y==x.brain){if(E.target.level==w&&(E.direction=="down"&&E.levelUp==w||E.direction=="up"&&E.levelDown==w||E.direction==undefined))O()}else{O()}}}function O(){var t=E.stageX;if(!f&&!d&&!l&&!h&&!v&&!p){var r=50;t<r?n=r:t>Canvas.width-r?n=Canvas.width-r:n=Utils.round(t);n>e.content.x?u=1:u=-1;e.animation.direction=90*u;M();f=true;l=d=h=v=p=false;AnimationsCollection.play("ed")}}function M(){e.animation.onAnimationEnd=_;switch(y){case x["inside"]:t="edWood";break;case x["outside"]:BackgroundManager.snow==true?t="edSnow":t="edGround";break;case x["clouds"]:t="edSnow";break;case x["brain"]:w<3?t="edPipe":t="edMud";break}if($()==1)e.animation.gotoAndPlay("start");else e.animation.gotoAndPlay("start_h")}function _(){e.animation.onAnimationEnd=D;if($()==1)e.animation.gotoAndPlay("walk");else e.animation.gotoAndPlay("walk_h");SoundManager.playOnForce(t)}function D(){_()}function P(){u=1;f=l=h=v=c=p=false;d=true;X();e.animation.onAnimationEnd=F;e.animation.gotoAndPlay("pull");AnimationsCollection.play("ed")}function H(t){if(e.content.x>410&&e.content.x<500){E=t;f=d=h=v=c=p=false;l=true;X();AnimationsCollection.play("ed")}}function B(t){E=t;var n=E.stageY;if(!f||d){r=n;r>e.content.y?a=1:a=-1;f=d=h=v=c=l=false;p=true;AnimationsCollection.play("ed")}}function j(e){E=e;f=d=h=p=c=l=false;v=true;X();AnimationsCollection.play("ed")}function F(t,n){e.events.dispatch("animationEvent",null,{action:"onPullEnd"});e.animation.onAnimationEnd=I}function I(t,n){X();e.animation.onAnimationEnd=null;f=false;d=false;l=false;h=false;v=false}function q(t){E=t;f=d=h=p=v=l=false;c=true;X();e.animation.onAnimationEnd=R;e.animation.gotoAndPlay("jump");AnimationsCollection.play("ed")}function R(t,n){e.animation.onAnimationEnd=U;e.animation.gotoAndPlay("jumpEnd");e.events.dispatch("jumpStarted",null,E)}function U(t,n){e.animation.onAnimationEnd=null;e.animation.gotoAndStop(77);c=false}function z(t){E=t;f=d=h=p=v=l=false;c=true;X();e.animation.gotoAndStop("landing_h");e.events.dispatch("landingStarted",null,E);AnimationsCollection.play("ed")}function W(){e.animation.onAnimationEnd=null;u==-1;X();AnimationsCollection.stop("ed");c=false}function X(){u==1?e.animation.gotoAndStop("pull"):e.animation.gotoAndStop("pull_h");e.content.updateCache()}function V(){S=true;A({stageX:Canvas.width/2,type:"background",demo:false})}function $(){var e=u;S==true?e=u*-1:e=u;return e}function J(){if(f||l||h||d||v||p||c){e.content.updateCache()}if(f){var m=u*(e.content.x-n);if(m<0){e.content.x+=i*u}else{SoundManager.playOff(t);e.content.x=n;f=false;AnimationsCollection.stop("ed");e.animation.onAnimationEnd=null;X();e.events.dispatch("walkComplete",null,E)}}else if(l){m=-e.content.y-500;if(m<0){e.content.y-=s}else{e.content.y=-500;l=false;AnimationsCollection.stop("ed");X();e.events.dispatch("flyComplete",null,E)}}else if(h){m=e.content.y-x[E.next].y;if(m<0){e.content.y+=x[E.next].vY}else{e.content.y=x[E.next].y;h=false;AnimationsCollection.stop("ed");X();e.events.dispatch("landingComplete",null,E)}}else if(v){m=e.content.y-(Canvas.height+500);if(m<0){e.content.y+=s}else{e.content.y=Canvas.height+500;v=false;AnimationsCollection.stop("ed");X();if(E.action=="edLanding")E.action="changeContainer";e.events.dispatch("fallingComplete",null,E)}}else if(p){var m=a*(e.content.y-r);if(m<0){e.content.y+=o*a}else{e.content.y=r;p=false;AnimationsCollection.stop("ed");e.events.dispatch("moveComplete",null,E)}}else if(c){}}function K(){return f}function Q(){return y}function G(e){w=e}var e=new AbstractCreature,t;var n=0,r=0,i=4,s=40,o=10,u=1,a=1,f=false,l=false,c=false,h=false,p=false,d=false,v=false,m=0,g=0,y,b,w=0,E,S=false;var x={inside:{x:150,y:Canvas.height-200,scale:1,vX:4,vY:40},outside:{x:Canvas.width/2+170,y:Canvas.height-175,scale:.5,vX:2,vY:40},clouds:{x:150,y:Canvas.height-300,scale:1,vX:4,vY:40},brain:{x:350,y:68,scale:.43,vX:2,vY:10}};this.init=T;this.abstract=e;this.walkTo=A;this.pull=P;this.fly=H;this.landTo=j;this.flyTo=B;this.isMoving=K;this.jumpToTube=q;this.jumpFromTube=z;this.jumpFromTubeEnd=W;this.setLevel=G;this.moonWalk=V;this.stopAnimation=X;this.onTick=J;this.locations=x;this.setLocation=L;this.stageReady=k;this.getCurrentLocation=Q}function FairyCreature(){function t(){e.content=new createjs.Container;e.sprite=new createjs.SpriteSheet({frames:{regX:0,regY:0,height:60,width:63,count:50},images:["media/spritesheets/fairy.png"],animations:{all:[0,49]}});e.animation=new createjs.BitmapAnimation(e.sprite);e.name=e.animation.name="fairy";e.sprite.getAnimation("all").next="all";e.content.addChild(e.animation);e.content.x=265;e.content.y=230;e.content.snapToPixel=true;e.animation.onTick=n;e.content.cache(0,0,63,60);e.animation.gotoAndPlay("all")}function n(){e.content.updateCache()}var e=new AbstractCreature;this.init=t;this.abstract=e}function ReindeerCreature(){function l(){e.content=new createjs.Container;e.name="reindeer";e.sprite=new createjs.SpriteSheet({animations:{pull:[0,14],rage:[15,18],moo:[19,35],moo2:[36,73],horseshoe:[75,102],still:[103,109]},images:["media/spritesheets/reindeer.png"],frames:{width:176,regY:0,height:175,count:109,regX:0}});r=new createjs.SpriteSheet({animations:{h_pull:[0,14],h_rage:[15,18],h_moo:[19,35],h_moo2:[36,73],h_horseshoe:[75,102],h_still:[103,109]},images:["media/spritesheets/reindeerHorseshoe.png"],frames:{width:61,regY:0,height:46,count:109,regX:0}});u=setInterval(c,500)}function c(){if(e.sprite.complete&&r.complete){clearInterval(u);h()}}function h(){e.animation=new createjs.BitmapAnimation(e.sprite);e.animation.name="reindeer";var t=new createjs.Bitmap("media/img/sledge.png");e.content.addChild(t);var n=new createjs.Bitmap("media/img/stripe.png");n.x=t.image.width;n.y=49;e.content.addChild(n);e.animation.x=Utils.round(n.x+n.image.width-16);e.animation.y=-22;e.content.addChild(e.animation);s=new createjs.BitmapAnimation(r);s.x=e.animation.x+50;s.y=e.animation.y+125;s.alpha=0;e.content.addChild(s);a=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(0,0,0,.05)).rect(-10,-10,35,35));a.x=e.animation.x;a.y=60;e.content.addChild(a);a.onPress=C;a.onMouseOut=L;a.onMouseOver=A;e.content.scaleX=.8;e.content.scaleY=.8;e.content.x=100;e.content.y=Canvas.height-208;e.content.snapToPixel=true;e.content.cache(0,-12,e.animation.x+175,176+12);e.animation.onTick=k;T();e.events.dispatch("initComplete")}function p(){e.content.updateCache()}function d(){i=true;n=true;s.alpha=1;e.animation.onAnimationEnd=v;e.animation.gotoAndPlay("horseshoe");s.gotoAndPlay("h_horseshoe");SoundManager.playOnForce("reindeerHorseshoe");PromptManager.active("outside","last")}function v(t,r){if(r=="horseshoe"){e.animation.onAnimationEnd=null;e.animation.gotoAndStop("still");s.gotoAndStop("h_still");n=false;e.content.updateCache()}}function m(){if(!n){n=true;t+=1;e.animation.onAnimationEnd=w;e.animation.gotoAndPlay("pull");s.gotoAndPlay("h_pull");AnimationsCollection.play("reindeer")}}function g(){f+=1;e.animation.gotoAndPlay("rage");s.gotoAndPlay("h_rage")}function y(){e.animation.gotoAndPlay("moo");s.gotoAndPlay("h_moo");SoundManager.playOn("reindeer")}function b(){e.events.dispatch("reindeerMoo",null,{stageX:e.content.x,target:a,type:"exit",action:"changeContainer",next:"clouds"});e.animation.gotoAndPlay("moo2");s.gotoAndPlay("h_moo2");SoundManager.playOn("reindeer")}function w(t,n){e.animation.onAnimationEnd=E;g()}function E(n,r){if(t<2){e.animation.onAnimationEnd=S;y()}else{N();if(f<20){g()}else{t=0;f=0;e.animation.onAnimationEnd=S;y()}}}function S(t,n){e.animation.onAnimationEnd=x;b()}function x(t,r){e.animation.onAnimationEnd=null;T();AnimationsCollection.stop("reindeer");n=false;o=false}function T(){e.animation.gotoAndStop("pull");s.gotoAndStop("h_pull");e.content.updateCache()}function N(){if(!o){PromptManager.active("outside","horseshoe");o=true;e.events.dispatch("reindeerMoveEd")}}function C(t){var n=e.content.localToGlobal(t.target.x-30,t.target.y);e.events.dispatch("onPressEvent",null,{stageX:n.x,target:t.target,type:e.type,action:"reindeerPull",demo:false})}function k(){if(n){e.content.updateCache()}}function L(e){$("body").css("cursor","default")}function A(e){$("body").css("cursor","pointer")}var e=new AbstractCreature;var t=0,n=false,r,i=false,s,o=false,u;var a,f=0;this.init=l;this.abstract=e;this.pull=m;this.stopAnimation=T;this.onTick=k;this.showHorseshoe=d;this.reindeerCacheUpdate=p}function SantaClausCreature(){function o(){e.content=new createjs.Container;e.sprite=new createjs.SpriteSheet({animations:{sleep:[0,0],wakeUp:[1,51],hohoho:[52,118]},images:["media/spritesheets/santa0.png","media/spritesheets/santa1.png","media/spritesheets/santa2.png"],frames:{width:290,regY:0,height:281,count:119,regX:0}});s=setInterval(u,300)}function u(){if(e.sprite.complete){clearInterval(s);a()}}function a(){e.animation=new createjs.BitmapAnimation(e.sprite);e.content.addChild(e.animation);e.name=e.animation.name="santaClaus";e.content.snapToPixel=true;e.content.x=Canvas.width-310;e.content.y=Canvas.height-280;e.animation.gotoAndStop(0);e.content.onTick=f;e.content.cache(0,0,290,281)}function f(){if(t||r){e.content.updateCache()}}function l(){return r}function c(){e.animation.gotoAndStop(1);PromptManager.active("inside","last")}function h(){SoundManager.playOff("snore");SoundManager.removeSoundFromLocation("inside","snore");e.animation.onAnimationEnd=p;e.animation.gotoAndPlay("wakeUp")}function p(){e.animation.onAnimationEnd=d;e.animation.gotoAndPlay("hohoho");SoundManager.playOn("hohoho")}function d(){e.animation.gotoAndStop("hohoho");setTimeout(v,2e3)}function v(){e.events.dispatch("gameEnd")}var e=new AbstractCreature;var t,n,t=true,r=false,i=false,s;this.init=o;this.abstract=e;this.onTick=f;this.showBeard=c;this.wakeUp=h}function AngelHairItem(){function t(){e.content=new createjs.Container;e.content.mouseEnabled=true;e.type="item";e.demo=false;e.action="addToBackpackOther";var t=new createjs.Bitmap("media/img/angelHair.png");t.x=445;t.y=338;e.content.addChild(t);var n=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,0,.01)).rect(0,0,94,31));n.x=445;n.y=338;e.content.addChild(n);var r=new createjs.Bitmap("media/img/angelHair.png");r.x=520;r.y=450;r.rotation=-95;r.scaleX=r.scaleY=.8;e.content.addChild(r);var i=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,0,.01)).rect(0,0,94,31));i.x=520;i.y=450;i.rotation=-95;i.scaleX=i.scaleY=.8;e.content.addChild(i);var s=new createjs.Bitmap("media/img/angelHair.png");s.x=550;s.y=300;s.rotation=-75;s.scaleX=s.scaleY=.8;e.content.addChild(s);var o=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,0,.01)).rect(0,0,94,31));o.x=550;o.y=300;o.rotation=-75;o.scaleX=o.scaleY=.8;e.content.addChild(o);e.otherContent=new createjs.Bitmap("media/img/angelHair2.png");e.name=e.otherContent.name="angelHair";e.otherContent.relationObjectName="cloud";e.otherContent.regX=Utils.round(e.otherContent.image.width/2);e.otherContent.regY=Utils.round(e.otherContent.image.height/2);e.afterAddToBackpack=function(){PromptManager.disactive("angelHair1");PromptManager.active("angelHair2")};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function BeardItem(){function t(){e.content=new createjs.Bitmap("media/img/beard.png");e.name=e.content.name="beard";e.demo=false;e.content.relationObjectName="santaClaus";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function BottleFairyItem(){function t(){e.content=new createjs.Bitmap("media/img/bottleFairy.png");e.name=e.content.name="bottleFairy";e.content.relationObjectName="horseshoe";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.demo=false;e.action="addToBackpack";e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function BottleItem(){function t(){e.content=new createjs.Bitmap("media/img/bottle.png");e.name=e.content.name="bottle";e.demo=false;e.content.relationObjectName="fairy";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.action="addToBackpack";e.content.level=2;e.afterAddToBackpack=function(){PromptManager.disactive("bottle1");PromptManager.active("bottle2");game.controller.brainCleanUp()};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function BtnBackpackItem(){function n(){bitmap=new createjs.Bitmap("media/img/btnSmallRound.png");e.content=new createjs.Container;e.content.width=bitmap.image.width;e.content.height=bitmap.image.height;e.content.regX=bitmap.image.width/2;e.content.regY=bitmap.image.height/2;e.content.x=10+e.content.regX;e.content.y=10+e.content.regY;e.type="item";e.demo=false;e.action="promptInfo";bitmap=new createjs.Bitmap("media/img/btnSmallRound.png");e.content.addChild(bitmap);bitmap.onPress=e.onPress;t=new createjs.Bitmap("media/img/toolbarIco.png");t.regX=Utils.round(t.image.width/2);t.regY=Utils.round(t.image.height/2);t.x=Utils.round(bitmap.image.width/2)+2;t.y=Utils.round(bitmap.image.height/2)-4;e.content.addChild(t);e.content.snapToPixel=true;e.init()}function r(){AnimationsCollection.play("promptBtn");var t=createjs.Tween.get(e.content,{loop:false}).to({scaleX:.8,scaleY:.8},150,createjs.Ease.bounceOut).wait(20).to({scaleX:1,scaleY:1},150,createjs.Ease.bounceOut).call(function(){AnimationsCollection.stop("promptBtn")})}var e=new AbstractItem;var t;this.init=n;this.animate=r;this.abstract=e}function BtnPromptItem(){function r(){bitmap=new createjs.Bitmap("media/img/btnSmallRound.png");e.content=new createjs.Container;e.content.width=bitmap.image.width;e.content.height=bitmap.image.height;e.content.regX=e.content.width/2;e.content.regY=e.content.height/2;e.content.x=10+e.content.regX;e.content.y=Canvas.height-10-e.content.regY;e.type="item";e.demo=false;e.action="promptInfo";e.content.addChild(bitmap);t=new createjs.Bitmap("media/img/promptsIco.png");t.regX=Utils.round(t.image.width/2);t.regY=Utils.round(t.image.height/2);t.x=Utils.round(bitmap.image.width/2)+2;t.y=Utils.round(bitmap.image.height/2)-4;e.content.addChild(t);e.content.snapToPixel=true;e.init()}function i(){AnimationsCollection.play("promptBtn");var t=createjs.Tween.get(e.content,{loop:false}).to({scaleX:.8,scaleY:.8},150,createjs.Ease.linear).wait(20).to({scaleX:1,scaleY:1},150,createjs.Ease.linear).call(function(){AnimationsCollection.stop("promptBtn")})}function s(){}function o(){AnimationsCollection.play("promptBtnActive");if(undefined!=n)n.pause(n);e.content.scaleX=1;e.content.scaleY=1}var e=new AbstractItem;var t;var n;this.init=r;this.animate=i;this.activeAnimateStart=s;this.activeAnimateStop=o;this.abstract=e}function BtnSoundItem(){function n(){e.content=new createjs.Container;e.demo=false;e.type="item";e.action="soundSwitch";bitmap=new createjs.Bitmap("media/img/btnSmallRound.png");bitmap.onPress=e.onPress;e.content.width=bitmap.image.width;e.content.height=bitmap.image.height;e.content.regX=bitmap.image.width/2;e.content.regY=bitmap.image.height/2;e.content.x=Utils.round(Canvas.width-bitmap.image.width/2-10);e.content.y=Utils.round(bitmap.image.height/2+10);e.content.addChild(bitmap);icons=new createjs.SpriteSheet({images:["media/spritesheets/soundIcons.png"],frames:{width:27,height:30,count:2}});t=new createjs.BitmapAnimation(icons);t.x=11;t.y=3;e.content.addChild(t);e.init();e.content.cache(-e.content.regX,-e.content.regY,bitmap.image.width*2,bitmap.image.height*2);e.content.snapToPixel=true;SoundManager.isSoundOn?this.soundOn():this.soundOff();e.content.onTick=u}function r(){t.gotoAndStop(2);game.update=true;e.content.updateCache()}function i(){t.gotoAndStop(1);game.update=true;e.content.updateCache()}function s(){SoundManager.isSoundOn?this.soundOn():this.soundOff();e.content.updateCache()}function o(){AnimationsCollection.play("soundBtn");var t=createjs.Tween.get(e.content,{loop:false}).to({scaleX:.8,scaleY:.8},150,createjs.Ease.bounceOut).wait(20).to({scaleX:1,scaleY:1},150,createjs.Ease.bounceOut).call(function(){AnimationsCollection.stop("soundBtn")})}function u(){if(createjs.Tween.hasActiveTweens(e.content)){e.content.updateCache()}}var e=new AbstractItem;var t;this.init=n;this.animate=o;this.abstract=e;this.change=s;this.soundOn=r;this.soundOff=i}function CakeItem(){function t(){e.content=new createjs.Bitmap("media/img/cake.png");e.name=e.content.name="cakePre";e.content.relationObjectName="knife";e.content.mouseEnabled=true;e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.demo=true;e.action="addToBackpack";e.afterAddToBackpack=function(){e.name=e.content.name="cake";PromptManager.disactive("demo1");PromptManager.active("demo2");game.controller.guiManager.gui.popup.on();game.controller.demoPart2()};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function CakePiecesItem(){function t(){e.content=new createjs.Bitmap("media/img/cakePieces.png");e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.name=e.content.name="cakePieces";e.content.relationObjectName="clock";e.type="item";e.demo=true;e.action="addToBackpack";e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function CatHairItem(){function t(){e.content=new createjs.Bitmap("media/img/catHair.png");e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.otherContent=new createjs.Bitmap("media/img/catHair2.png");e.name=e.otherContent.name="catHair";e.demo=false;e.otherContent.relationObjectName="honey";e.otherContent.regX=Utils.round(e.otherContent.image.width/2);e.otherContent.regY=Utils.round(e.otherContent.image.height/2);e.type="item";e.action="addToBackpackOther";e.afterAddToBackpack=function(){PromptManager.disactive("catHair1");PromptManager.active("catHair2")};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function ClockItem(){function l(){e.content=new createjs.Container;e.name=e.content.name="clock";e.demo=false;e.type="background";t=new createjs.SpriteSheet({animations:{open:[0,43],open2:[0,13],shout:[14,43],eat:[44,58],close:[59,73]},images:["media/spritesheets/clock.png"],frames:{width:114,regY:0,height:194,count:74,regX:0}});n=new createjs.BitmapAnimation(t);e.name=n.name="clock";n.scaleX=n.scaleY=1;i=new createjs.Bitmap("media/img/pendulum.png");i.x=51;i.y=110;e.content.addChild(i);e.content.addChild(n);s=new createjs.Bitmap("media/img/hour.png");s.x=59;s.y=96;s.regX=4;s.regY=11;e.content.addChild(s);o=new createjs.Bitmap("media/img/minute.png");o.x=59;o.y=96;o.regX=3;o.regY=18;e.content.addChild(o);var r=new createjs.Shape;nW=90;nH=130;r.graphics.beginFill(createjs.Graphics.getRGB(255,255,255,.5)).drawRect(22,0,nW,nH);e.content.hitArea=r;e.content.snapToPixel=true;e.init(true);e.content.cache(0,0,114,194);n.gotoAndStop("open");c();p();setInterval(p,15e3);e.content.onTick=x}function c(){createjs.Tween.get(i,{loop:true}).to({rotation:-15},500,createjs.Ease.sineOut).call(function(){SoundManager.playOn("clockPendulum")}).to({rotation:15},1e3,createjs.Ease.sineInOut).call(function(){SoundManager.playOn("clockPendulum")}).to({rotation:0},500,createjs.Ease.sineIn)}function h(){createjs.Tween.removeTweens(i);createjs.Tween.get(i).to({rotation:0},300,createjs.Ease.sineInOut);SoundManager.playOff("clockPendulum")}function p(){var t=new Date;var n=t.getHours();var r=t.getMinutes();if(n>12)n-=12;var i=360/12;var u=360/60;s.rotation=i*(n+r/60);o.rotation=u*r;e.content.updateCache()}function d(t){AnimationsCollection.play("clock");a=t;a.x=60;a.y=60;a.scaleX=a.scaleY=.6;e.content.addChild(a);e.content.updateCache();h();n.onAnimationEnd=m;n.gotoAndPlay("open");SoundManager.playOn("clockOpen")}function v(){r=true;clearInterval(u);n.onAnimationEnd=m;n.gotoAndPlay("eat");r=true}function m(){n.gotoAndStop(58);u=setInterval(v,500);r=false}function g(){f=0;clearInterval(u);e.content.removeChild(a);n.onAnimationEnd=y;n.gotoAndPlay("close");SoundManager.playOn("clockClose");c();r=true}function y(){if(f<3)b();else S()}function b(){n.onAnimationEnd=w;n.gotoAndPlay("open2");SoundManager.playOn("clockOpen");f+=1}function w(){n.onAnimationEnd=E;n.gotoAndPlay("shout");SoundManager.playOn("clockShout")}function E(){n.onAnimationEnd=y;n.gotoAndPlay("close");SoundManager.playOn("clockClose")}function S(){n.onAnimationEnd=null;n.gotoAndStop("open");e.events.dispatch("clockShoutComplete")}function x(){if(r||createjs.Tween.hasActiveTweens(i)){e.content.updateCache()}}var e=new AbstractItem,t,n,r=true,i,s,o,u,a,f=0;this.init=l;this.abstract=e;this.eat=v;this.addCake=d;this.shout=g}function CloudItem(){function r(){e.content=new createjs.Container;t=new createjs.Bitmap("media/img/cloud.png");e.name!=null?t.name=e.name:t.name="cloud";e.type="object";e.demo=false;e.action="sewCloud";e.content.addChild(t);n=new createjs.Bitmap("media/img/cloudThread.png");n.x=145;n.y=30;e.content.snapToPixel=true;e.content.cache(0,0,t.image.width,t.image.height);e.init(true)}function i(){e.content.addChild(n);e.content.updateCache()}function s(){e.content.updateCache()}var e=new AbstractItem,t,n;this.init=r;this.abstract=e;this.sewCloud=i;this.cacheUpdate=s}function DemoGrid(){function t(){var t=Canvas.width;var n=Canvas.height;var r=t/50;var s=n/50;e.graphics.beginStroke(createjs.Graphics.getRGB(255,255,0,.5)).setStrokeStyle(1);for(i=0;i<r;i++){e.graphics.moveTo(i*50,0);e.graphics.lineTo(i*50,n)}for(j=0;j<s;j++){e.graphics.moveTo(0,j*50);e.graphics.lineTo(t,j*50)}e.graphics.closePath()}var e=new createjs.Shape;this.init=t;this.content=e}function DoorItem(){function t(){e.content=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,0,0,.01)).rect(0,0,100,100));e.type="exit";e.demo=false;e.action="changeContainer";e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function DoorLevelItem(){function t(){e.content=new createjs.Container;e.type="level";e.action="changeLevel";e.demo=false;e.content.addChild(e.contentUp);e.content.addChild(e.contentDown);e.init()}var e=new AbstractDoorLevelItem;this.init=t;this.abstract=e}function GramophoneItem(){function i(){e.content=new createjs.Container;e.name=e.content.name="gramophone";e.demo=false;e.type="background";t=new createjs.SpriteSheet({animations:{all:[0,19]},images:["media/spritesheets/gramophone.png"],frames:{width:118,regY:0,height:96,count:20,regX:0}});n=new createjs.BitmapAnimation(t);t.getAnimation("all").next="all";e.content.addChild(n);e.content.snapToPixel=true;e.init(true);e.content.cache(0,0,118,96);n.gotoAndPlay("all");e.content.onTick=s}function s(){if(r){e.content.updateCache()}}function o(){r=false;n.stop();SoundManager.playOn("gramophoneStop");SoundManager.playOff("gramophone");SoundManager.removeSoundFromLocation("inside","gramophone")}var e=new AbstractItem,t,n,r=true;this.init=i;this.abstract=e;this.stop=o}function HoneyItem(){function t(){e.content=new createjs.Bitmap("media/img/honey.png");e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.name=e.content.name="honeyPre";e.type="item";e.demo=false;e.action="addToBackpack";e.afterAddToBackpack=function(){e.name=e.content.name="honey";e.content.relationObjectName="catHair";PromptManager.disactive("honey1");PromptManager.active("honey2")};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function HorseshoeItem(){function t(){e.content=new createjs.Bitmap("media/img/horseshoe.png");e.name=e.content.name="horseshoePre";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.demo=false;e.action="addToBackpack";e.afterAddToBackpack=function(){e.name=e.content.name="horseshoe";e.content.relationObjectName="bottleFairy";PromptManager.disactive("horseshoe1");PromptManager.active("horseshoe2")};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function KnifeItem(){function t(){e.content=new createjs.Bitmap("media/img/knife.png");e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.name=e.content.name="knifePre";e.type="item";e.demo=false;e.action="addToBackpack";e.afterAddToBackpack=function(){e.name=e.content.name="knife";e.content.relationObjectName="cake";PromptManager.disactive("demo2");PromptManager.active("demo3");game.controller.guiManager.gui.popup.on()};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function MagicHorseshoeItem(){function t(){e.content=new createjs.Bitmap("media/img/magicHorseshoe.png");e.name=e.content.name="magicHorseshoePre";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.demo=false;e.action="addToBackpack";e.afterAddToBackpack=function(){e.name=e.content.name="magicHorseshoe";e.content.relationObjectName="reindeer"};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function MaskItem(){function t(){e.content=new createjs.Bitmap("media/img/mask.png");e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.name=e.content.name="mask";e.content.relationObjectName="cat";e.type="item";e.demo=false;e.action="addToBackpack";e.content.level=3;e.afterAddToBackpack=function(){PromptManager.disactive("mask1");PromptManager.active("mask2");game.controller.brainCleanUp()};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function PopupItem(){function u(){e.type="item";e.action="PromptView";e.demo=false;e.content=new createjs.Container;e.content.alpha=0;e.content.visible=false;var t=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.01)).rect(0,0,Canvas.width,Canvas.height);background=new createjs.Shape(t);background.onPress=this.off;e.content.addChild(background);popupBG=new createjs.Bitmap("media/img/popup.png");popupBG.x=Canvas.width/2-285;popupBG.y=Canvas.height/2-80;e.content.addChild(popupBG);n=new createjs.Text("","Bold 19px "+fontName,"#080808");n.text="";n.textAlign="center";n.x=popupBG.x+285;n.y=popupBG.y+30;n.lineWidth=520;e.content.addChild(n);var t=(new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.01)).rect(0,0,Canvas.width,Canvas.height);background=new createjs.Shape(t);background.onPress=h;e.content.addChild(background);s=new createjs.Bitmap("media/img/arrowL.png");s.x=popupBG.x-94;s.y=popupBG.y+65;s.onPress=m;s.onMouseOut=f;s.onMouseOver=l;e.content.addChild(s);o=new createjs.Bitmap("media/img/arrowR.png");o.x=popupBG.x+581;o.y=popupBG.y+60;o.onPress=v;o.onMouseOut=f;o.onMouseOver=l;e.content.addChild(o);var r=new createjs.Shape((new createjs.Graphics).beginFill(createjs.Graphics.getRGB(255,255,255,.02)).rect(popupBG.x+520,popupBG.y+10,25,28));r.onMouseOut=f;r.onMouseOver=l;r.onPress=h;e.content.addChild(r);e.init(true,false);e.content.onPress=null}function a(){t?this.off():this.on()}function f(e){$("body").css("cursor","default")}function l(e){$("body").css("cursor","pointer")}function c(){r=PromptManager.getActualPrompts();o.visible=s.visible=r.length!=1;i=0;e.events.dispatch("disactivePrompt",null,{});this.setTextFromPromptManager();AnimationsCollection.play("popup");e.content.visible=true;t=true;var n=createjs.Tween.get(e.content,{loop:false}).to({alpha:1},250,createjs.Ease.linear).call(function(){AnimationsCollection.stop("popup")});game.update=true}function h(){t=false;e.content.alpha=0;e.content.visible=false;game.update=true;e.events.dispatch("popupOff")}function p(e){n.text=e}function d(){n.text=r[i];n.y=popupBG.y+115-Utils.round(n.getMeasuredHeight()/2);game.update=true}function v(){i++;if(i>r.length-1)i=0;d()}function m(){i--;if(i<0)i=r.length-1;d()}var e=new AbstractItem;var t=false;var n=null;var r=[];var i=0,s,o;this.init=u;this.abstract=e;this.on=c;this.off=h;this.setText=p;this.switchView=a;this.setTextFromPromptManager=d}function SnowItem(){function i(){e.content=new createjs.Container;e.content.onTick=a;e.init();e.content.onPress=null}function s(){e.content.visible=true;for(var n=0;n<r;n++){u(n)}t=true}function o(){t=false;for(var n=0;n<r;n++){e.content.removeChild(e.content.getChildAt(n))}e.content.visible=false}function u(t,r){var i=new createjs.Bitmap("media/img/snowflake.png");i.x=Math.random()*300+45;i.y=Math.random()*50;r==true?i.alpha=1:i.alpha=0;i.rotation=Math.random()*300;i.speed=n*(Math.random()*1+.5);i.index=t;e.content.addChildAt(i,t);i.cache(0,0,14,14)}function a(){if(t){for(var n=0;n<r;n++){var i=e.content.getChildAt(n);i.y+=i.speed;i.updateCache();if(i.y>Canvas.height){var s=i.index;e.content.removeChild(i);u(s,true)}}}}var e=new AbstractItem,t=false,n=10,r=50;this.init=i;this.abstract=e;this.startSnowing=s;this.stopSnowing=o}function SoundSwitchItem(){function t(){e.content=new createjs.Container;data={images:["media/spritesheets/soundSwitcher_0.png"],frames:{width:35,height:30}};e.sprite=new createjs.SpriteSheet(data);e.animation=new createjs.BitmapAnimation(e.sprite);e.content.addChild(e.animation);e.type="item";e.demo=false;e.action="soundSwitch";e.init();SoundManager.isSoundOn?this.soundOn():this.soundOff()}function n(){e.animation.gotoAndStop(2);game.update=true}function r(){e.animation.gotoAndStop(1);game.update=true}function i(){SoundManager.isSoundOn?this.soundOn():this.soundOff()}var e=new AbstractItem;this.init=t;this.abstract=e;this.change=i;this.soundOn=n;this.soundOff=r}function StarItem(){function i(){e.content=new createjs.Container;e.demo=false;e.type="item";t=new createjs.SpriteSheet({animations:{all:[0,1]},images:["media/spritesheets/star.png"],frames:{width:219,regY:0,height:213,count:2,regX:0}});n=new createjs.BitmapAnimation(t);t.getAnimation("all").next="all";e.content.addChild(n);e.content.snapToPixel=true;e.init(true);e.content.cache(0,0,219,213);n.gotoAndStop("all");e.name!=null?n.name=e.name:n.name="star";e.content.updateCache();e.content.onTick=u}function s(){r=true;n.play();SoundManager.playOn("starLightUp1");setTimeout(a,400)}function o(){r=false;n.gotoAndStop(1);e.content.updateCache()}function u(){if(r){e.content.updateCache()}}function a(){r=false;n.gotoAndStop(1);SoundManager.playOn("starLightUp2");e.content.updateCache()}function f(){e.content.updateCache()}var e=new AbstractItem,t,n,r=false;this.init=i;this.abstract=e;this.stop=a;this.lightUp=s;this.lightUpStill=o;this.cacheUpdate=f}function ThunderboltItem(){function t(){e.content=new createjs.Bitmap("media/img/thunderbolt.png");e.name=e.content.name="thunderbolt";e.demo=false;e.content.relationObjectName="star";e.content.regX=Utils.round(e.content.image.width/2);e.content.regY=Utils.round(e.content.image.height/2);e.type="item";e.action="addToBackpack";e.content.level=3;e.afterAddToBackpack=function(){PromptManager.disactive("thunderbolt1");PromptManager.active("thunderbolt2");game.controller.brainCleanUp()};e.init()}var e=new AbstractItem;this.init=t;this.abstract=e}function TubeItem(){function t(){e.content=new createjs.Bitmap("media/img/tube.png");e.name=e.content.name="tube";e.demo=false;e.content.relationObjectName="santaClaus";e.content.mouseEnabled=true;e.content.regX=e.content.image.width/2;e.content.regY=e.content.image.height/2;e.type="item";e.action="addToBackpack";e.afterAddToBackpack=function(){PromptManager.disactive("tube1");PromptManager.active("tube2")};e.init(false,true)}var e=new AbstractItem;this.init=t;this.abstract=e}function BackpackCollection(){function f(){n.visible=false;n.alpha=0;n.x=r;n.y=i;n.addChild(new createjs.Bitmap("media/img/bgBackpack.png"))}function l(){cnt=e.getFirstFreeIndex(10);pattern=[{x:73,y:60},{x:133,y:57},{x:200,y:55},{x:271,y:48},{x:341,y:49},{x:78,y:123},{x:141,y:116},{x:224,y:110},{x:296,y:109},{x:369,y:97}];return pattern[cnt]}function c(){AnimationsCollection.play("backpack");n.visible=true;var e=createjs.Tween.get(n,{loop:false}).to({alpha:1},250,createjs.Ease.linear).call(function(){AnimationsCollection.stop("backpack")})}function h(){AnimationsCollection.play("backpack");var e=createjs.Tween.get(n,{loop:false}).to({alpha:0},250,createjs.Ease.linear).call(function(){AnimationsCollection.stop("backpack")});n.visible=false}function p(){n.isVisible()?h():c()}function d(t){this.show();SoundManager.play("click");var r=this._getXY();t.x=r.x;t.y=r.y;var i=t.scaleX;if(t.image.width>=t.image.height){t.scaleY=t.scaleX=u/t.image.width}else{t.scaleX=t.scaleY=a/t.image.height}if(t.scaleX>1){t.scaleX=t.scaleY=i}else{i=t.scaleX}t.onMouseOver=function(){t.scaleY=t.scaleY*1.1;t.scaleX=t.scaleX*1.1;game.update=true};t.onMouseOut=function(){t.scaleY=t.scaleY/1.1;t.scaleX=t.scaleX/1.1;game.update=true};tmpThis=this;t.onPress=function(e){t.parent.addChild(t);var s={x:t.x-e.stageX,y:t.y-e.stageY};e.onMouseMove=function(e){t.scaleX=.8;t.scaleY=.8;t.x=e.stageX+s.x;t.y=e.stageY+s.y;game.update=true};e.onMouseUp=function(e){t.x=e.stageX+s.x;t.y=e.stageY+s.y;var o=n.localToGlobal(t.x,t.y);data=stageGlobal.getObjectsUnderPoint(o.x,o.y);idMerge=tmpThis.checkObjectRelation(t,data);if(idMerge>0){game.controller.backpackItemsMerge(t)}else{t.x=r.x;t.y=r.y;t.scaleX=t.scaleY=i}game.update=true}};e.add(t);n.addChild(t);game.update=true}function v(t){return e.getByName(t)}function m(t){var r=e.getByName(t);n.removeChild(r);e.removeByName(t)}function g(e,t){if(t.length<1)return 0;for(index in t){if(t[index].name===e.relationObjectName)return t[index].id}return 0}var e=new AbstractCollection,t=new Event,n=new createjs.Container;var r=55,i=20,s=412,o=162,u=33,a=33;this.init=f;this._getXY=l;this.add=d;this.show=c;this.hide=h;this.switchView=p;this.items=e;this.events=t;this.content=n;this.checkObjectRelation=g;this.removeByName=m;this.getByName=v}function ContainersCollection(){function t(t){e.add({container:t,name:t.abstract.name})}function n(t){if(e.getByName(t))return e.getByName(t).container;else return undefined}function r(){return e.getCount()}function i(t){return e.getByIndex(t)}var e=new AbstractCollection;this.add=t;this.getByName=n;this.length=r;this.getByIndex=i}var Canvas={width:960,height:540,context:null,html:null,orientation:"landscape",create:function(e){canv=document.createElement("canvas");canv.height=this.height;canv.width=this.width;canv.id="canvasStage";document.getElementById("wraper").appendChild(canv);this.html=document.getElementById("canvasStage");this.context=this.html.getContext("2d");e()},clear:function(){this.context.clearRect(0,0,this.html.width,this.html.height)},getXMargin:function(){position=this.html;return position.left-this.x/2},getYMargin:function(){position=this.html;return position.top-this.y/2},getMarginVector:function(){return[this.getXMargin(),this.getYMargin()]},scale:function(){switch(this._getWindowOrientation()){case"landscape":this.orientation="landscape";this.scaleLandscape();break;case"portrait":this.orientation="portrait";this.scalePortrait();break}},scalePortrait:function(){if(isMobile.any()){$("#rotateOverlay").show();return}$("#canvas").css({transform:"rotate(90deg)","-webkit-transform":"rotate(90deg)","-moz-transform":"rotate(90deg)","-o-transform":"rotate(90deg)","-ms-transform":"rotate(90deg)"});pCanvas=this.height/this.width;wW=$(window).width();wH=$(window).height();pWindow=wH/wW;if(pWindow<this.width/this.height){newH=Utils.round(wH*this.height/this.width);$("#canvas").css({width:wH,height:newH,marginTop:-newH/2,marginLeft:-wH/2})}else{newW=Utils.round(wW*this.width/this.height);$("#canvas").css({width:newW,height:wW,marginTop:-wW/2,marginLeft:-newW/2})}},scaleLandscape:function(){$("#rotateOverlay").hide();$("#canvas").css({transform:"rotate(0deg)","-webkit-transform":"rotate(0deg)","-moz-transform":"rotate(0deg)","-o-transform":"rotate(0deg)","-ms-transform":"rotate(0deg)"});pCanvas=this.width/this.height;wW=$(window).width();wH=$(window).height();pWindow=wW/wH;if(pWindow>=pCanvas){newW=Utils.round(wH*this.width/this.height);$("#canvas").css({width:newW,height:wH,marginTop:-wH/2,marginLeft:-newW/2})}else{newH=Utils.round(wW*this.height/this.width);$("#canvas").css({width:wW,height:newH,marginTop:-newH/2,marginLeft:-wW/2})}},_getWindowOrientation:function(){return $(window).width()<$(window).height()?"portrait":"landscape"}};var isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Opera()||isMobile.Windows()}};var Utils={round:function(e){return.5+e|0}};var BackgroundManager={element:$("#canvasBg"),manifest:[],snow:false,init:function(){this.add("inside","media/img/insideBg.jpg");this.add("outside","media/img/outsideBg.jpg");this.add("outsideSnow","media/img/outsideSnowBg.jpg");this.add("clouds","media/img/cloudsBg.jpg");this.add("brain","media/img/brainBg.jpg");this.add("init","media/img/init.jpg")},add:function(e,t){this.manifest[e]=t},show:function(e){if(undefined!=this.manifest[e]){if(e=="outside"&&BackgroundManager.snow)e="outsideSnow";this.element.css("background-image","url("+this.manifest[e]+")");this.element.fadeIn(200)}},hide:function(){this.element.fadeOut(200)}};var MergeManager={cloudReady:false,starReady:false,santaClausReady:false,reindeerReady:false,knife:function(e){game.controller.backpackRemoveByName("cake");game.controller.backpackRemoveByName("knife");var t=new CakePiecesItem;t.init();var n={content:t.abstract.content,type:t.abstract.type,next:t.abstract.arg,target:t.abstract.content,after:t.abstract.afterAddToBackpack,demo:true};game.controller.addToBackpack(n,true);SoundManager.playOn("merge");PromptManager.disactive("demo3");PromptManager.active("demo4");game.controller.guiManager.gui.popup.on()},cake:function(e){MergeManager.knife(e)},cakePieces:function(e){game.controller.backpackRemoveByName("cakePieces");game.controller.animationManager.clockEat(e);game.controller.hideBackpack();SoundManager.playOn("merge");game.controller.guiManager.abstract.events.addEventListener("popupOff",MergeManager.afterCakePromptClose);PromptManager.disactive("demo4");PromptManager.active("demo5");game.controller.guiManager.gui.popup.on();game.controller.demoEnd()},afterCakePromptClose:function(e){game.controller.guiManager.abstract.events.removeEventListener("popupOff",MergeManager.afterCakePromptClose);PromptManager.disactive("demo5");PromptManager.active("tube1");PromptManager.active("honey1");PromptManager.active("fairy1");PromptManager.active("angelHair1");PromptManager.active("inside")},tube:function(e){game.controller.backpackRemoveByName("tube");game.controller.animationManager.showTube();game.controller.hideBackpack();SoundManager.playOn("merge");PromptManager.disactive("tube2")},honey:function(e){game.controller.backpackRemoveByName("honey");game.controller.backpackRemoveByName("catHair");var t=new BeardItem;t.init();var n={content:t.abstract.content,type:t.abstract.type,next:t.abstract.arg,target:t.abstract.content,after:t.abstract.afterAddToBackpack,demo:false};game.controller.addToBackpack(n,true);SoundManager.playOn("beard");PromptManager.disactive("honey2");PromptManager.disactive("catHair2");PromptManager.active("beard")},catHair:function(e){MergeManager.honey(e)},bottle:function(e){game.controller.backpackRemoveByName("bottle");game.controller.animationManager.hideFairy();var t=new BottleFairyItem;t.init();var n={content:t.abstract.content,type:t.abstract.type,next:t.abstract.arg,target:t.abstract.content,after:t.abstract.afterAddToBackpack,demo:false};game.controller.addToBackpack(n,true);SoundManager.playOn("fairy");PromptManager.disactive("bottle2");PromptManager.disactive("fairy1");PromptManager.active("fairy2")},mask:function(e){game.controller.backpackRemoveByName("mask");game.controller.animationManager.scareCat();game.controller.hideBackpack();SoundManager.playOn("cat");PromptManager.disactive("mask2");PromptManager.active("catHair1")},bottleFairy:function(e){game.controller.backpackRemoveByName("bottleFairy");game.controller.backpackRemoveByName("horseshoe");var t=new MagicHorseshoeItem;t.init();var n={content:t.abstract.content,type:t.abstract.type,next:t.abstract.arg,target:t.abstract.content,after:t.abstract.afterAddToBackpack,demo:false};game.controller.addToBackpack(n,true);SoundManager.playOn("magicHorseshoe");PromptManager.disactive("horseshoe2");PromptManager.disactive("fairy2");PromptManager.active("magicHorseshoe")},beard:function(e){game.controller.backpackRemoveByName("beard");game.controller.animationManager.showBeard();game.controller.hideBackpack();MergeManager.santaClausReady=true;MergeManager.checkAllTasks();SoundManager.playOn("merge");PromptManager.disactive("beard");PromptManager.disactive("inside")},horseshoe:function(e){MergeManager.bottleFairy(e)},magicHorseshoe:function(e){game.controller.backpackRemoveByName("magicHorseshoe");game.controller.animationManager.showMagicHorseshoe();game.controller.hideBackpack();MergeManager.reindeerReady=true;MergeManager.checkAllTasks();PromptManager.disactive("magicHorseshoe")},angelHair:function(e){game.controller.backpackRemoveByName("angelHair");game.controller.gameplayManager.sewCloud();SoundManager.playOn("cloud");BackgroundManager.snow=true;game.controller.hideBackpack();MergeManager.cloudReady=true;MergeManager.checkAllTasks();PromptManager.disactive("angelHair2");PromptManager.disactive("outside3")},thunderbolt:function(e){game.controller.backpackRemoveByName("thunderbolt");game.controller.gameplayManager.lightStar();game.controller.hideBackpack();MergeManager.starReady=true;MergeManager.checkAllTasks();PromptManager.disactive("thunderbolt2");PromptManager.disactive("outside2")},checkAllTasks:function(e){if(MergeManager.cloudReady&&MergeManager.starReady&&MergeManager.santaClausReady&&MergeManager.reindeerReady==true){game.controller.gameFinish()}}};var PromptManager={hasNewPrompt:false,collection:[],collectionCnt:0,activeNames:[],activeNamesCnt:0,events:new Event,init:function(){},getActualPrompts:function(){var e=[];var t=[];if(this.activeNamesCnt==0)return e;activeContainer=game.controller.gameplayManager.getCurrent();for(index in this.activeNames){if(this.collection[index].locationName==activeContainer){e.push(this.collection[index].text)}else{t.push(this.collection[index].text)}}return e.concat(t)},add:function(e){if(undefined!=this.collection[e.name])return;this.collection[e.name]=e;this.collectionCnt++},active:function(e){if(undefined==this.collection[e])return;this.activeNames[e]=true;this.activeNamesCnt++},disactive:function(e){if(undefined==this.activeNames[e])return;delete this.activeNames[e];this.activeNamesCnt--}};var SoundManager={isSoundOn:false,collection:[],locations:[],actualLocation:"",path:"media/audio/",play:function(e,t){if(t===undefined)t=false;if(this.collection[e]===undefined)return;if(!this.isSoundOn)return;if(t)this.collection[e].source.setAttribute("loop","loop");this.collection[e].source.play()},add:function(e){e.global=false;this.collection[e.name]=e},addLocation:function(e){this.locations[e]={soundNames:[]}},addSoundToLocation:function(e,t){this.locations[e].soundNames.push(t)},removeSoundFromLocation:function(e,t){for(index in this.locations[e].soundNames){if(t==this.locations[e].soundNames[index]){delete this.locations[e].soundNames[index];return}}},playOffAll:function(e){if(undefined===e)e=this.actualLocation;if(undefined===this.locations[e])return;if(this.locations[e].soundNames.length>0){for(index in this.locations[e].soundNames){soundName=this.locations[e].soundNames[index];this.collection[soundName].source.pause()}}},playOnAll:function(e){if(undefined===e)e=this.actualLocation;if(undefined===this.locations[e])return;if(this.locations[e].soundNames.length>0){for(index in this.locations[e].soundNames){soundName=this.locations[e].soundNames[index];this.play(soundName,true)}}},playOff:function(e){if(undefined===this.collection[e])return;this.collection[e].source.pause()},playOn:function(e){if(undefined===this.collection[e])return;if(this.isSoundOn)this.collection[e].source.play()},playOnForce:function(e){if(undefined===this.collection[e])return;if(this.isSoundOn){this.collection[e].source.currentTime=0;this.collection[e].source.play()}},mute:function(){for(index in this.collection){this.collection[index].source.pause()}},switchSound:function(){if(this.isSoundOn){this.isSoundOn=false;this.mute()}else{this.isSoundOn=true;this.playOnAll()}},_getBrowserExtension:function(){if(navigator.userAgent.indexOf("Firefox")>0)return".ogg";return".mp3"}};var AnimationsCollection={collection:new AbstractCollection,play:function(e){animation=this.collection.getByName(e);if(animation==undefined){this.add(e)}else{animation.playing=true;game.animating=true}},add:function(e){this.collection.add({name:e,playing:true});game.animating=true},stop:function(e){this.collection.getByName(e).playing=false;if(this.collection.getByObjectAttribute("playing",true).length==0)game.animating=false},length:function(){return this.collection.getCount()}}